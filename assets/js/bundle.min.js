function sendToDify(e){console.log("é€ä¿¡é–‹å§‹"),fetch("https://selectlanchserver.onrender.com/send-to-dify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({inputs:{country:e.selectedCountry,main:e.selectedMain,dish:e.selectedMainDish},user:"user"})}).then(e=>{if(!e.ok)throw new Error("Difyé€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸã€‚");return e.json()}).then(e=>{console.log(e);const t=e.data?.outputs?.result??"AIã‹ã‚‰ã®è¿”ç­”ãŒã‚ã‚Šã¾ã›ã‚“";console.log("Difyã®è¿”ç­”",t);const n=`/result.html?ai=${encodeURIComponent(t)}`;document.getElementById("resultBox").innerHTML=`\n      <br>\n      <a href="${n}" target="_blank" style="color: #2196f3; font-weight: bold;">\n        ğŸ¤– AIã®ææ¡ˆã‚’åˆ¥ãƒšãƒ¼ã‚¸ã§è¦‹ã‚‹\n      </a>\n    `}).catch(e=>{console.error("ã‚¨ãƒ©ãƒ¼",e)})}document.addEventListener("DOMContentLoaded",function(){let e={selectedCountry:null,selectedMain:null,selectedMainDish:null};function t(t,n,s,o){const r=document.getElementById(t),i=document.getElementById(n);let c=[];r.addEventListener("click",function(){let t;c.length===s.length&&(c=[],console.log("å…¨ã¦è¡¨ç¤ºã•ã‚ŒãŸã®ã§ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã€‚"));do{t=Math.floor(Math.random()*s.length)}while(c.includes(t));c.push(t);const n=s[t];i.textContent=n,e[o]=n,function(){const t=Object.values(e);t.every(e=>null!==e)&&setTimeout(()=>{const t=`ä»Šæ—¥ã®ã”é£¯ã¯â€¦<br>\n          ğŸ½ï¸ <strong>ã‚¸ãƒ£ãƒ³ãƒ«ï¼š</strong>${e.selectedCountry}<br>\n          ğŸ <strong>ä¸»é£Ÿï¼š</strong>${e.selectedMain}<br>\n          ğŸ– <strong>ãƒ¡ã‚¤ãƒ³ï¼š</strong>${e.selectedMainDish}<br>\n          <button id="askAIButton">AIã«ãƒ¬ã‚·ãƒ”èã</button>`,n=document.getElementById("resultBox");n.innerHTML=t,n.classList.add("show");document.getElementById("askAIButton").addEventListener("click",()=>{const t=`${e.selectedCountry}ã®æ–™ç†ã§ã€ä¸»é£Ÿã¯${e.selectedMain}ã€ãƒ¡ã‚¤ãƒ³ã¯${e.selectedMainDish}ã®ãƒ¬ã‚·ãƒ”ã‚’æ•™ãˆã¦`;sendToDify(e),alert("AIã«ãƒ¬ã‚·ãƒ”ã‚’èã„ã¦ã„ã¾ã™ã€‚:\n\n"+t)}),setTimeout(()=>{n.classList.remove("show"),n.innerHTML="",e={selectedCountry:null,selectedMain:null,selectedMainDish:null},document.getElementById("selectedCountry").textContent="",document.getElementById("selectedMain").textContent="",document.getElementById("selectedMainDish").textContent=""},5e4)},200)}()})}document.getElementById("askAIButton").addEventListener("click",function(){Object.values(e).every(e=>null!==e)?sendToDify(e):alert("å…¨ã¦ã®é …ç›®ã‚’é¸ã‚“ã§ã‹ã‚‰AIã«èã„ã¦ä¸‹ã•ã„")}),t("selectCountryButton","selectedCountry",["ä¸­è¯","ã‚¤ã‚¿ãƒªã‚¢ãƒ³","å’Œé£Ÿ","ã‚¢ãƒ¡ãƒªã‚«"],"selectedCountry"),t("selectMainButton","selectedMain",["ç™½ç±³","å’Œã‚ã‚“","ãƒ‘ã‚¹ã‚¿","ã±ã‚“"],"selectedMain"),t("selectMainDishButton","selectedMainDish",["é¶è‚‰","ç‰›è‚‰","è±šè‚‰","é­š","é­šä»‹ï¼ˆé­šä»¥å¤–"],"selectedMainDish")});const defaultOptions={pagination:{el:".swiper-pagination",clickable:!0},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},loop:!0,slidesPerView:1},swiper=new Swiper(".sample-swiper .swiper-container",{...defaultOptions}),swiperFade=new Swiper(".sample-swiper-fade .swiper-container",{...defaultOptions,effect:"fade",fadeEffect:{crossFade:!0}}),swiperCoverflow=new Swiper(".sample-swiper-coverflow .swiper-container",{...defaultOptions,slidesPerView:1.6,centeredSlides:!0,effect:"coverflow",coverflowEffect:{rotate:0,stretch:50,depth:200,slideShadows:!0}}),swiperCards=new Swiper(".sample-swiper-cards .swiper-container",{...defaultOptions,grabCursor:!0,effect:"cards"}),swiperCreative=new Swiper(".sample-swiper-creative .swiper-container",{...defaultOptions,grabCursor:!0,effect:"creative",creativeEffect:{prev:{shadow:!0,translate:[0,0,-400]},next:{translate:["100%",0,0]}}});if(document.getElementById("searchInput")){let e={},t="all";function performSearch(){const t=document.getElementById("searchInput").value.toLowerCase();document.getElementById("resultsGrid");if(!t)return void displayAllDishes();const n=[];for(const[s,o]of Object.entries(e))for(const[e,r]of Object.entries(o))r.forEach(o=>{const r="string"==typeof o?o:o.name||"";(r.toLowerCase().includes(t)||e.toLowerCase().includes(t)||s.toLowerCase().includes(t))&&n.push({dish:r,country:e,region:s})});displayResults(n)}function displayAllDishes(){const t=[];for(const[n,s]of Object.entries(e))for(const[e,o]of Object.entries(s))o.forEach(s=>{const o="string"==typeof s?s:s.name||"";t.push({dish:o,country:e,region:n})});displayResults(t)}function displayResults(e){const t=document.getElementById("resultsGrid");0!==e.length?t.innerHTML=e.map(e=>`\n      <div class="dish-card">\n        <div class="dish-card__header">\n          <h3 class="dish-card__name">${e.dish}</h3>\n        </div>\n        <div class="dish-card__body">\n          <p class="dish-card__country">\n            <i class="fas fa-map-marker-alt"></i> ${e.country}\n          </p>\n          <p class="dish-card__region">\n            <i class="fas fa-globe"></i> ${e.region}\n          </p>\n        </div>\n      </div>\n    `).join(""):t.innerHTML='<p class="no-results">æ¤œç´¢çµæœãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ</p>'}fetch("/dishes.json").then(e=>e.json()).then(t=>{e=t,displayAllDishes()}).catch(e=>{console.error("æ–™ç†ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ:",e)}),document.getElementById("searchButton").addEventListener("click",performSearch),document.getElementById("searchInput").addEventListener("keypress",function(e){"Enter"===e.key&&performSearch()}),document.querySelectorAll(".filter__button").forEach(e=>{e.addEventListener("click",function(){document.querySelectorAll(".filter__button").forEach(e=>e.classList.remove("active")),this.classList.add("active"),t=this.dataset.category,performSearch()})})}